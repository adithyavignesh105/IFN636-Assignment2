{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\adith\\\\OneDrive\\\\Desktop\\\\IFN636_Assignment2\\\\Frontend\\\\src\\\\components\\\\Dashboard.jsx\",\n  _s = $RefreshSig$();\n// src/components/Dashboard.jsx\nimport React, { useEffect, useMemo, useState } from \"react\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst API_URL = process.env.REACT_APP_API_URL || \"http://localhost:5000/api\";\nasync function api(path, {\n  method = \"GET\",\n  body,\n  token\n} = {}) {\n  const res = await fetch(`${API_URL}${path}`, {\n    method,\n    headers: {\n      \"Content-Type\": \"application/json\",\n      ...(token ? {\n        Authorization: `Bearer ${token}`\n      } : {})\n    },\n    ...(body ? {\n      body: JSON.stringify(body)\n    } : {})\n  });\n  const data = await res.json().catch(() => ({}));\n  if (!res.ok) throw new Error(data.message || res.statusText);\n  return data;\n}\nfunction SectionCard({\n  title,\n  subtitle,\n  children,\n  footer\n}) {\n  return /*#__PURE__*/_jsxDEV(\"section\", {\n    className: \"rounded-2xl border border-slate-200 bg-white shadow-sm\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"border-b border-slate-100 px-5 py-4\",\n      children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n        className: \"text-xl font-semibold text-slate-800\",\n        children: title\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 24,\n        columnNumber: 9\n      }, this), subtitle && /*#__PURE__*/_jsxDEV(\"p\", {\n        className: \"mt-1 text-sm text-slate-500\",\n        children: subtitle\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 25,\n        columnNumber: 22\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 23,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"px-5 py-5\",\n      children: children\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 27,\n      columnNumber: 7\n    }, this), footer && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"border-t border-slate-100 px-5 py-4\",\n      children: footer\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 28,\n      columnNumber: 18\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 22,\n    columnNumber: 5\n  }, this);\n}\n_c = SectionCard;\nfunction Field({\n  label,\n  children,\n  help,\n  error\n}) {\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"grid gap-1.5\",\n    children: [label && /*#__PURE__*/_jsxDEV(\"label\", {\n      className: \"text-sm font-medium text-slate-700\",\n      children: label\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 36,\n      columnNumber: 17\n    }, this), children, help && !error && /*#__PURE__*/_jsxDEV(\"p\", {\n      className: \"text-xs text-slate-500\",\n      children: help\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 38,\n      columnNumber: 26\n    }, this), error && /*#__PURE__*/_jsxDEV(\"p\", {\n      className: \"text-xs text-rose-600\",\n      children: error\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 39,\n      columnNumber: 17\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 35,\n    columnNumber: 5\n  }, this);\n}\n_c2 = Field;\nfunction InputBase({\n  className = \"\",\n  ...props\n}) {\n  return /*#__PURE__*/_jsxDEV(\"input\", {\n    className: \"h-10 w-full rounded-lg border border-slate-300 bg-white px-3 text-sm text-slate-800 outline-none transition focus:border-blue-500 focus:ring-4 focus:ring-blue-100 \" + className,\n    ...props\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 46,\n    columnNumber: 5\n  }, this);\n}\n_c3 = InputBase;\nfunction SelectBase({\n  className = \"\",\n  ...props\n}) {\n  return /*#__PURE__*/_jsxDEV(\"select\", {\n    className: \"h-10 w-full rounded-lg border border-slate-300 bg-white px-3 text-sm text-slate-800 outline-none transition focus:border-blue-500 focus:ring-4 focus:ring-blue-100 \" + className,\n    ...props\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 58,\n    columnNumber: 5\n  }, this);\n}\n_c4 = SelectBase;\nfunction Button({\n  children,\n  variant = \"primary\",\n  className = \"\",\n  ...props\n}) {\n  const base = \"inline-flex items-center justify-center rounded-lg px-4 py-2.5 text-sm font-medium transition focus:outline-none focus:ring-4 disabled:opacity-60\";\n  const styles = variant === \"primary\" ? \"bg-blue-600 text-white hover:bg-blue-700 focus:ring-blue-100\" : \"bg-slate-100 text-slate-800 hover:bg-slate-200 focus:ring-slate-100\";\n  return /*#__PURE__*/_jsxDEV(\"button\", {\n    className: `${base} ${styles} ${className}`,\n    ...props,\n    children: children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 76,\n    columnNumber: 5\n  }, this);\n}\n_c5 = Button;\nfunction Alert({\n  kind = \"error\",\n  children\n}) {\n  const styles = kind === \"error\" ? \"bg-rose-50 text-rose-700 border border-rose-200\" : \"bg-emerald-50 text-emerald-700 border border-emerald-200\";\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    role: \"status\",\n    className: `rounded-lg px-3 py-2 text-sm ${styles}`,\n    \"aria-live\": \"polite\",\n    children: children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 88,\n    columnNumber: 5\n  }, this);\n}\n_c6 = Alert;\nexport default function Dashboard() {\n  _s();\n  // ---- auth token (adjust if stored differently) ----\n  const [token] = useState(() => localStorage.getItem(\"token\") || \"\");\n\n  // ---- data for the page ----\n  const [myShifts, setMyShifts] = useState([]);\n  const [users, setUsers] = useState([]);\n  const [loading, setLoading] = useState(true);\n  const [loadMsg, setLoadMsg] = useState(\"\");\n\n  // ---- request swap state ----\n  const [yourShiftId, setYourShiftId] = useState(\"\");\n  const [targetUserId, setTargetUserId] = useState(\"\");\n  const [targetDate, setTargetDate] = useState(\"\"); // yyyy-mm-dd\n  const [targetShiftId, setTargetShiftId] = useState(\"\");\n  const [findingTarget, setFindingTarget] = useState(false);\n  const [msg, setMsg] = useState({\n    type: \"\",\n    text: \"\"\n  });\n\n  // ---------- load initial data ----------\n  useEffect(() => {\n    let cancelled = false;\n    async function load() {\n      try {\n        setLoading(true);\n        setLoadMsg(\"\");\n        const mine = await api(`/shifts?mine=1`, {\n          token\n        });\n\n        // If /users is Manager-only, replace with your teammates endpoint.\n        let people = [];\n        try {\n          people = await api(`/users`, {\n            token\n          });\n        } catch {\n          people = [];\n        }\n        if (!cancelled) {\n          var _mine$;\n          setMyShifts(Array.isArray(mine) ? mine : []);\n          setUsers(Array.isArray(people) ? people : []);\n          if (mine !== null && mine !== void 0 && (_mine$ = mine[0]) !== null && _mine$ !== void 0 && _mine$._id) setYourShiftId(mine[0]._id);\n        }\n      } catch (e) {\n        if (!cancelled) setLoadMsg(e.message);\n      } finally {\n        if (!cancelled) setLoading(false);\n      }\n    }\n    load();\n    return () => {\n      cancelled = true;\n    };\n  }, [token]);\n\n  // ---------- resolve targetShiftId whenever user+date change ----------\n  useEffect(() => {\n    let cancelled = false;\n    async function resolveTarget() {\n      setMsg({\n        type: \"\",\n        text: \"\"\n      });\n      setTargetShiftId(\"\");\n      if (!targetUserId || !targetDate) return;\n      try {\n        setFindingTarget(true);\n        const list = await api(`/shifts?userId=${encodeURIComponent(targetUserId)}&date=${encodeURIComponent(targetDate)}`, {\n          token\n        });\n        if (!cancelled) {\n          const found = Array.isArray(list) && list.length ? list[0] : null;\n          setTargetShiftId(found ? found._id : \"\");\n          if (!found) setMsg({\n            type: \"error\",\n            text: \"Selected user has no shift on that date.\"\n          });\n        }\n      } catch (e) {\n        if (!cancelled) setMsg({\n          type: \"error\",\n          text: e.message\n        });\n      } finally {\n        if (!cancelled) setFindingTarget(false);\n      }\n    }\n    resolveTarget();\n    return () => {\n      cancelled = true;\n    };\n  }, [targetUserId, targetDate, token]);\n  async function handleSwapSubmit(e) {\n    e.preventDefault();\n    setMsg({\n      type: \"\",\n      text: \"\"\n    });\n    if (!yourShiftId || !targetUserId || !targetDate) {\n      setMsg({\n        type: \"error\",\n        text: \"Please select: My shift, User to swap with, and Target date.\"\n      });\n      return;\n    }\n    if (!targetShiftId) {\n      setMsg({\n        type: \"error\",\n        text: \"Selected user has no shift on the chosen date.\"\n      });\n      return;\n    }\n    try {\n      const payload = {\n        yourShiftId,\n        targetUserId,\n        targetShiftId,\n        targetDate\n      };\n      const res = await api(`/shifts/swap`, {\n        method: \"POST\",\n        body: payload,\n        token\n      });\n      setMsg({\n        type: \"success\",\n        text: res.message || \"Swap request created.\"\n      });\n    } catch (e) {\n      setMsg({\n        type: \"error\",\n        text: e.message || \"Failed to create swap request.\"\n      });\n    }\n  }\n  const myShiftOptions = useMemo(() => myShifts.map(s => {\n    var _s$user;\n    return {\n      id: s._id,\n      label: `${new Date(s.date).toLocaleDateString()} — ${((_s$user = s.user) === null || _s$user === void 0 ? void 0 : _s$user.name) || \"Me\"}`\n    };\n  }), [myShifts]);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"min-h-screen bg-slate-50\",\n    children: [/*#__PURE__*/_jsxDEV(\"header\", {\n      className: \"sticky top-0 z-10 border-b border-slate-200 bg-white/90 backdrop-blur\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"mx-auto max-w-6xl px-4 py-4\",\n        children: /*#__PURE__*/_jsxDEV(\"h1\", {\n          className: \"text-2xl font-semibold text-slate-900\",\n          children: \"Leave & Shift Manager\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 218,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 217,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 216,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"main\", {\n      className: \"mx-auto max-w-6xl px-4 py-6 grid gap-6 md:grid-cols-2\",\n      children: [/*#__PURE__*/_jsxDEV(SectionCard, {\n        title: \"My Shifts\",\n        subtitle: \"Your upcoming shifts (local time).\",\n        footer: loadMsg ? /*#__PURE__*/_jsxDEV(Alert, {\n          kind: \"error\",\n          children: loadMsg\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 230,\n          columnNumber: 15\n        }, this) : /*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"text-xs text-slate-500\",\n          children: [\"Showing \", myShifts.length, \" shift(s).\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 232,\n          columnNumber: 15\n        }, this),\n        children: loading ? /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"space-y-2\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"h-4 w-40 animate-pulse rounded bg-slate-200\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 238,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"h-4 w-56 animate-pulse rounded bg-slate-200\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 239,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"h-4 w-48 animate-pulse rounded bg-slate-200\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 240,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 237,\n          columnNumber: 13\n        }, this) : /*#__PURE__*/_jsxDEV(\"ul\", {\n          className: \"divide-y divide-slate-100\",\n          children: [myShifts.map(s => {\n            var _s$user2;\n            return /*#__PURE__*/_jsxDEV(\"li\", {\n              className: \"flex items-center justify-between py-3\",\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"flex items-center gap-3\",\n                children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                  className: \"inline-flex items-center rounded-full bg-blue-50 px-2.5 py-1 text-xs font-medium text-blue-700\",\n                  children: new Date(s.date).toLocaleDateString()\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 247,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                  className: \"text-sm text-slate-700\",\n                  children: ((_s$user2 = s.user) === null || _s$user2 === void 0 ? void 0 : _s$user2.name) || \"Me\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 250,\n                  columnNumber: 21\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 246,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"text-xs text-slate-400\",\n                children: [\"id: \", s._id]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 254,\n                columnNumber: 19\n              }, this)]\n            }, s._id, true, {\n              fileName: _jsxFileName,\n              lineNumber: 245,\n              columnNumber: 17\n            }, this);\n          }), !myShifts.length && /*#__PURE__*/_jsxDEV(\"li\", {\n            className: \"py-2 text-sm text-slate-500\",\n            children: \"No shifts found.\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 258,\n            columnNumber: 17\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 243,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 225,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(SectionCard, {\n        title: \"Request Swap\",\n        subtitle: \"Pick your shift, a colleague, and the date you want to swap.\",\n        footer: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex items-center justify-between\",\n          children: [/*#__PURE__*/_jsxDEV(\"p\", {\n            className: \"text-xs text-slate-500\",\n            children: \"Need help? Ensure the selected user actually has a shift on that date.\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 270,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"text-xs text-slate-400\",\n            children: targetShiftId ? `Target shift: ${targetShiftId}` : \"\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 273,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 269,\n          columnNumber: 13\n        }, this),\n        children: /*#__PURE__*/_jsxDEV(\"form\", {\n          onSubmit: handleSwapSubmit,\n          className: \"grid gap-4\",\n          children: [/*#__PURE__*/_jsxDEV(Field, {\n            label: \"My shift\",\n            help: \"Choose the shift you want to swap away.\",\n            children: /*#__PURE__*/_jsxDEV(SelectBase, {\n              value: yourShiftId,\n              onChange: e => setYourShiftId(e.target.value),\n              children: myShiftOptions.map(o => /*#__PURE__*/_jsxDEV(\"option\", {\n                value: o.id,\n                children: o.label\n              }, o.id, false, {\n                fileName: _jsxFileName,\n                lineNumber: 289,\n                columnNumber: 19\n              }, this))\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 284,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 280,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"grid gap-4 md:grid-cols-2\",\n            children: [/*#__PURE__*/_jsxDEV(Field, {\n              label: \"User to swap with\",\n              help: \"Pick the colleague you want to swap with.\",\n              children: /*#__PURE__*/_jsxDEV(SelectBase, {\n                value: targetUserId,\n                onChange: e => setTargetUserId(e.target.value),\n                children: [/*#__PURE__*/_jsxDEV(\"option\", {\n                  value: \"\",\n                  children: \"Select a user\\u2026\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 302,\n                  columnNumber: 19\n                }, this), users.filter(u => !!(u !== null && u !== void 0 && u._id)).map(u => /*#__PURE__*/_jsxDEV(\"option\", {\n                  value: u._id,\n                  children: u.name\n                }, u._id, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 306,\n                  columnNumber: 23\n                }, this))]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 298,\n                columnNumber: 17\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 297,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(Field, {\n              label: \"Target date\",\n              help: \"We\\u2019ll look up that user\\u2019s shift on this date.\",\n              children: /*#__PURE__*/_jsxDEV(InputBase, {\n                type: \"date\",\n                value: targetDate,\n                onChange: e => setTargetDate(e.target.value)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 314,\n                columnNumber: 17\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 313,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 296,\n            columnNumber: 13\n          }, this), findingTarget && /*#__PURE__*/_jsxDEV(Alert, {\n            kind: \"success\",\n            children: \"Checking target shift\\u2026\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 323,\n            columnNumber: 15\n          }, this), msg.text && /*#__PURE__*/_jsxDEV(Alert, {\n            kind: msg.type === \"success\" ? \"success\" : \"error\",\n            children: msg.text\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 327,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"flex items-center gap-3 pt-2\",\n            children: [/*#__PURE__*/_jsxDEV(Button, {\n              type: \"submit\",\n              children: \"Request Swap\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 331,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(Button, {\n              type: \"button\",\n              variant: \"secondary\",\n              onClick: () => {\n                setTargetUserId(\"\");\n                setTargetDate(\"\");\n                setTargetShiftId(\"\");\n                setMsg({\n                  type: \"\",\n                  text: \"\"\n                });\n              },\n              children: \"Clear\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 332,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 330,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 279,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 265,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 223,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 214,\n    columnNumber: 5\n  }, this);\n}\n_s(Dashboard, \"mf0FZ1N1Tdx2H7bMQa6iWL/vyqA=\");\n_c7 = Dashboard;\nvar _c, _c2, _c3, _c4, _c5, _c6, _c7;\n$RefreshReg$(_c, \"SectionCard\");\n$RefreshReg$(_c2, \"Field\");\n$RefreshReg$(_c3, \"InputBase\");\n$RefreshReg$(_c4, \"SelectBase\");\n$RefreshReg$(_c5, \"Button\");\n$RefreshReg$(_c6, \"Alert\");\n$RefreshReg$(_c7, \"Dashboard\");","map":{"version":3,"names":["React","useEffect","useMemo","useState","jsxDEV","_jsxDEV","API_URL","process","env","REACT_APP_API_URL","api","path","method","body","token","res","fetch","headers","Authorization","JSON","stringify","data","json","catch","ok","Error","message","statusText","SectionCard","title","subtitle","children","footer","className","fileName","_jsxFileName","lineNumber","columnNumber","_c","Field","label","help","error","_c2","InputBase","props","_c3","SelectBase","_c4","Button","variant","base","styles","_c5","Alert","kind","role","_c6","Dashboard","_s","localStorage","getItem","myShifts","setMyShifts","users","setUsers","loading","setLoading","loadMsg","setLoadMsg","yourShiftId","setYourShiftId","targetUserId","setTargetUserId","targetDate","setTargetDate","targetShiftId","setTargetShiftId","findingTarget","setFindingTarget","msg","setMsg","type","text","cancelled","load","mine","people","_mine$","Array","isArray","_id","e","resolveTarget","list","encodeURIComponent","found","length","handleSwapSubmit","preventDefault","payload","myShiftOptions","map","s","_s$user","id","Date","date","toLocaleDateString","user","name","_s$user2","onSubmit","value","onChange","target","o","filter","u","onClick","_c7","$RefreshReg$"],"sources":["C:/Users/adith/OneDrive/Desktop/IFN636_Assignment2/Frontend/src/components/Dashboard.jsx"],"sourcesContent":["// src/components/Dashboard.jsx\r\nimport React, { useEffect, useMemo, useState } from \"react\";\r\n\r\nconst API_URL = process.env.REACT_APP_API_URL || \"http://localhost:5000/api\";\r\n\r\nasync function api(path, { method = \"GET\", body, token } = {}) {\r\n  const res = await fetch(`${API_URL}${path}`, {\r\n    method,\r\n    headers: {\r\n      \"Content-Type\": \"application/json\",\r\n      ...(token ? { Authorization: `Bearer ${token}` } : {}),\r\n    },\r\n    ...(body ? { body: JSON.stringify(body) } : {}),\r\n  });\r\n  const data = await res.json().catch(() => ({}));\r\n  if (!res.ok) throw new Error(data.message || res.statusText);\r\n  return data;\r\n}\r\n\r\nfunction SectionCard({ title, subtitle, children, footer }) {\r\n  return (\r\n    <section className=\"rounded-2xl border border-slate-200 bg-white shadow-sm\">\r\n      <div className=\"border-b border-slate-100 px-5 py-4\">\r\n        <h2 className=\"text-xl font-semibold text-slate-800\">{title}</h2>\r\n        {subtitle && <p className=\"mt-1 text-sm text-slate-500\">{subtitle}</p>}\r\n      </div>\r\n      <div className=\"px-5 py-5\">{children}</div>\r\n      {footer && <div className=\"border-t border-slate-100 px-5 py-4\">{footer}</div>}\r\n    </section>\r\n  );\r\n}\r\n\r\nfunction Field({ label, children, help, error }) {\r\n  return (\r\n    <div className=\"grid gap-1.5\">\r\n      {label && <label className=\"text-sm font-medium text-slate-700\">{label}</label>}\r\n      {children}\r\n      {help && !error && <p className=\"text-xs text-slate-500\">{help}</p>}\r\n      {error && <p className=\"text-xs text-rose-600\">{error}</p>}\r\n    </div>\r\n  );\r\n}\r\n\r\nfunction InputBase({ className = \"\", ...props }) {\r\n  return (\r\n    <input\r\n      className={\r\n        \"h-10 w-full rounded-lg border border-slate-300 bg-white px-3 text-sm text-slate-800 outline-none transition focus:border-blue-500 focus:ring-4 focus:ring-blue-100 \" +\r\n        className\r\n      }\r\n      {...props}\r\n    />\r\n  );\r\n}\r\n\r\nfunction SelectBase({ className = \"\", ...props }) {\r\n  return (\r\n    <select\r\n      className={\r\n        \"h-10 w-full rounded-lg border border-slate-300 bg-white px-3 text-sm text-slate-800 outline-none transition focus:border-blue-500 focus:ring-4 focus:ring-blue-100 \" +\r\n        className\r\n      }\r\n      {...props}\r\n    />\r\n  );\r\n}\r\n\r\nfunction Button({ children, variant = \"primary\", className = \"\", ...props }) {\r\n  const base =\r\n    \"inline-flex items-center justify-center rounded-lg px-4 py-2.5 text-sm font-medium transition focus:outline-none focus:ring-4 disabled:opacity-60\";\r\n  const styles =\r\n    variant === \"primary\"\r\n      ? \"bg-blue-600 text-white hover:bg-blue-700 focus:ring-blue-100\"\r\n      : \"bg-slate-100 text-slate-800 hover:bg-slate-200 focus:ring-slate-100\";\r\n  return (\r\n    <button className={`${base} ${styles} ${className}`} {...props}>\r\n      {children}\r\n    </button>\r\n  );\r\n}\r\n\r\nfunction Alert({ kind = \"error\", children }) {\r\n  const styles =\r\n    kind === \"error\"\r\n      ? \"bg-rose-50 text-rose-700 border border-rose-200\"\r\n      : \"bg-emerald-50 text-emerald-700 border border-emerald-200\";\r\n  return (\r\n    <div\r\n      role=\"status\"\r\n      className={`rounded-lg px-3 py-2 text-sm ${styles}`}\r\n      aria-live=\"polite\"\r\n    >\r\n      {children}\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default function Dashboard() {\r\n  // ---- auth token (adjust if stored differently) ----\r\n  const [token] = useState(() => localStorage.getItem(\"token\") || \"\");\r\n\r\n  // ---- data for the page ----\r\n  const [myShifts, setMyShifts] = useState([]);\r\n  const [users, setUsers] = useState([]);\r\n  const [loading, setLoading] = useState(true);\r\n  const [loadMsg, setLoadMsg] = useState(\"\");\r\n\r\n  // ---- request swap state ----\r\n  const [yourShiftId, setYourShiftId] = useState(\"\");\r\n  const [targetUserId, setTargetUserId] = useState(\"\");\r\n  const [targetDate, setTargetDate] = useState(\"\"); // yyyy-mm-dd\r\n  const [targetShiftId, setTargetShiftId] = useState(\"\");\r\n  const [findingTarget, setFindingTarget] = useState(false);\r\n  const [msg, setMsg] = useState({ type: \"\", text: \"\" });\r\n\r\n  // ---------- load initial data ----------\r\n  useEffect(() => {\r\n    let cancelled = false;\r\n    async function load() {\r\n      try {\r\n        setLoading(true);\r\n        setLoadMsg(\"\");\r\n        const mine = await api(`/shifts?mine=1`, { token });\r\n\r\n        // If /users is Manager-only, replace with your teammates endpoint.\r\n        let people = [];\r\n        try {\r\n          people = await api(`/users`, { token });\r\n        } catch {\r\n          people = [];\r\n        }\r\n\r\n        if (!cancelled) {\r\n          setMyShifts(Array.isArray(mine) ? mine : []);\r\n          setUsers(Array.isArray(people) ? people : []);\r\n          if (mine?.[0]?._id) setYourShiftId(mine[0]._id);\r\n        }\r\n      } catch (e) {\r\n        if (!cancelled) setLoadMsg(e.message);\r\n      } finally {\r\n        if (!cancelled) setLoading(false);\r\n      }\r\n    }\r\n    load();\r\n    return () => {\r\n      cancelled = true;\r\n    };\r\n  }, [token]);\r\n\r\n  // ---------- resolve targetShiftId whenever user+date change ----------\r\n  useEffect(() => {\r\n    let cancelled = false;\r\n    async function resolveTarget() {\r\n      setMsg({ type: \"\", text: \"\" });\r\n      setTargetShiftId(\"\");\r\n      if (!targetUserId || !targetDate) return;\r\n      try {\r\n        setFindingTarget(true);\r\n        const list = await api(\r\n          `/shifts?userId=${encodeURIComponent(\r\n            targetUserId\r\n          )}&date=${encodeURIComponent(targetDate)}`,\r\n          { token }\r\n        );\r\n        if (!cancelled) {\r\n          const found = Array.isArray(list) && list.length ? list[0] : null;\r\n          setTargetShiftId(found ? found._id : \"\");\r\n          if (!found) setMsg({ type: \"error\", text: \"Selected user has no shift on that date.\" });\r\n        }\r\n      } catch (e) {\r\n        if (!cancelled) setMsg({ type: \"error\", text: e.message });\r\n      } finally {\r\n        if (!cancelled) setFindingTarget(false);\r\n      }\r\n    }\r\n    resolveTarget();\r\n    return () => {\r\n      cancelled = true;\r\n    };\r\n  }, [targetUserId, targetDate, token]);\r\n\r\n  async function handleSwapSubmit(e) {\r\n    e.preventDefault();\r\n    setMsg({ type: \"\", text: \"\" });\r\n\r\n    if (!yourShiftId || !targetUserId || !targetDate) {\r\n      setMsg({ type: \"error\", text: \"Please select: My shift, User to swap with, and Target date.\" });\r\n      return;\r\n    }\r\n    if (!targetShiftId) {\r\n      setMsg({ type: \"error\", text: \"Selected user has no shift on the chosen date.\" });\r\n      return;\r\n    }\r\n\r\n    try {\r\n      const payload = { yourShiftId, targetUserId, targetShiftId, targetDate };\r\n      const res = await api(`/shifts/swap`, { method: \"POST\", body: payload, token });\r\n      setMsg({ type: \"success\", text: res.message || \"Swap request created.\" });\r\n    } catch (e) {\r\n      setMsg({ type: \"error\", text: e.message || \"Failed to create swap request.\" });\r\n    }\r\n  }\r\n\r\n  const myShiftOptions = useMemo(\r\n    () =>\r\n      myShifts.map((s) => ({\r\n        id: s._id,\r\n        label: `${new Date(s.date).toLocaleDateString()} — ${s.user?.name || \"Me\"}`,\r\n      })),\r\n    [myShifts]\r\n  );\r\n\r\n  return (\r\n    <div className=\"min-h-screen bg-slate-50\">\r\n      {/* Top bar */}\r\n      <header className=\"sticky top-0 z-10 border-b border-slate-200 bg-white/90 backdrop-blur\">\r\n        <div className=\"mx-auto max-w-6xl px-4 py-4\">\r\n          <h1 className=\"text-2xl font-semibold text-slate-900\">Leave &amp; Shift Manager</h1>\r\n        </div>\r\n      </header>\r\n\r\n      {/* Content grid */}\r\n      <main className=\"mx-auto max-w-6xl px-4 py-6 grid gap-6 md:grid-cols-2\">\r\n        {/* My Shifts */}\r\n        <SectionCard\r\n          title=\"My Shifts\"\r\n          subtitle=\"Your upcoming shifts (local time).\"\r\n          footer={\r\n            loadMsg ? (\r\n              <Alert kind=\"error\">{loadMsg}</Alert>\r\n            ) : (\r\n              <p className=\"text-xs text-slate-500\">Showing {myShifts.length} shift(s).</p>\r\n            )\r\n          }\r\n        >\r\n          {loading ? (\r\n            <div className=\"space-y-2\">\r\n              <div className=\"h-4 w-40 animate-pulse rounded bg-slate-200\" />\r\n              <div className=\"h-4 w-56 animate-pulse rounded bg-slate-200\" />\r\n              <div className=\"h-4 w-48 animate-pulse rounded bg-slate-200\" />\r\n            </div>\r\n          ) : (\r\n            <ul className=\"divide-y divide-slate-100\">\r\n              {myShifts.map((s) => (\r\n                <li key={s._id} className=\"flex items-center justify-between py-3\">\r\n                  <div className=\"flex items-center gap-3\">\r\n                    <span className=\"inline-flex items-center rounded-full bg-blue-50 px-2.5 py-1 text-xs font-medium text-blue-700\">\r\n                      {new Date(s.date).toLocaleDateString()}\r\n                    </span>\r\n                    <span className=\"text-sm text-slate-700\">\r\n                      {s.user?.name || \"Me\"}\r\n                    </span>\r\n                  </div>\r\n                  <span className=\"text-xs text-slate-400\">id: {s._id}</span>\r\n                </li>\r\n              ))}\r\n              {!myShifts.length && (\r\n                <li className=\"py-2 text-sm text-slate-500\">No shifts found.</li>\r\n              )}\r\n            </ul>\r\n          )}\r\n        </SectionCard>\r\n\r\n        {/* Request Swap */}\r\n        <SectionCard\r\n          title=\"Request Swap\"\r\n          subtitle=\"Pick your shift, a colleague, and the date you want to swap.\"\r\n          footer={\r\n            <div className=\"flex items-center justify-between\">\r\n              <p className=\"text-xs text-slate-500\">\r\n                Need help? Ensure the selected user actually has a shift on that date.\r\n              </p>\r\n              <div className=\"text-xs text-slate-400\">\r\n                {targetShiftId ? `Target shift: ${targetShiftId}` : \"\"}\r\n              </div>\r\n            </div>\r\n          }\r\n        >\r\n          <form onSubmit={handleSwapSubmit} className=\"grid gap-4\">\r\n            <Field\r\n              label=\"My shift\"\r\n              help=\"Choose the shift you want to swap away.\"\r\n            >\r\n              <SelectBase\r\n                value={yourShiftId}\r\n                onChange={(e) => setYourShiftId(e.target.value)}\r\n              >\r\n                {myShiftOptions.map((o) => (\r\n                  <option key={o.id} value={o.id}>\r\n                    {o.label}\r\n                  </option>\r\n                ))}\r\n              </SelectBase>\r\n            </Field>\r\n\r\n            <div className=\"grid gap-4 md:grid-cols-2\">\r\n              <Field label=\"User to swap with\" help=\"Pick the colleague you want to swap with.\">\r\n                <SelectBase\r\n                  value={targetUserId}\r\n                  onChange={(e) => setTargetUserId(e.target.value)}\r\n                >\r\n                  <option value=\"\">Select a user…</option>\r\n                  {users\r\n                    .filter((u) => !!u?._id)\r\n                    .map((u) => (\r\n                      <option key={u._id} value={u._id}>\r\n                        {u.name}\r\n                      </option>\r\n                    ))}\r\n                </SelectBase>\r\n              </Field>\r\n\r\n              <Field label=\"Target date\" help=\"We’ll look up that user’s shift on this date.\">\r\n                <InputBase\r\n                  type=\"date\"\r\n                  value={targetDate}\r\n                  onChange={(e) => setTargetDate(e.target.value)}\r\n                />\r\n              </Field>\r\n            </div>\r\n\r\n            {findingTarget && (\r\n              <Alert kind=\"success\">Checking target shift…</Alert>\r\n            )}\r\n\r\n            {msg.text && (\r\n              <Alert kind={msg.type === \"success\" ? \"success\" : \"error\"}>{msg.text}</Alert>\r\n            )}\r\n\r\n            <div className=\"flex items-center gap-3 pt-2\">\r\n              <Button type=\"submit\">Request Swap</Button>\r\n              <Button\r\n                type=\"button\"\r\n                variant=\"secondary\"\r\n                onClick={() => {\r\n                  setTargetUserId(\"\");\r\n                  setTargetDate(\"\");\r\n                  setTargetShiftId(\"\");\r\n                  setMsg({ type: \"\", text: \"\" });\r\n                }}\r\n              >\r\n                Clear\r\n              </Button>\r\n            </div>\r\n          </form>\r\n        </SectionCard>\r\n      </main>\r\n    </div>\r\n  );\r\n}\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}