{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\adith\\\\OneDrive\\\\Desktop\\\\IFN636_Assignment2\\\\Frontend\\\\src\\\\components\\\\EmployeeDashboard.jsx\",\n  _s = $RefreshSig$();\nimport React, { useEffect, useMemo, useState } from \"react\";\n\n/* ===== API paths (match your backend) ===== */\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst API = {\n  shifts: {\n    list: \"/api/shifts\",\n    // GET (employees get own shifts)\n    swap: \"/api/shifts/swap\" // POST (employee proposes swap)\n  },\n  leaves: {\n    list: \"/api/leaves\",\n    // GET\n    create: \"/api/leaves\" // POST\n  }\n};\n\n/* Safe body reader (JSON or text) */\nconst readBody = async res => {\n  const ct = res.headers.get(\"content-type\") || \"\";\n  if (ct.includes(\"application/json\")) {\n    try {\n      return await res.json();\n    } catch {\n      return null;\n    }\n  }\n  try {\n    return await res.text();\n  } catch {\n    return null;\n  }\n};\n\n/* Flexible date helpers (handles various field names) */\nconst dateFrom = obj => obj && (obj.startDate || obj.date || obj.from || obj.start || obj.shiftDate) || null;\nconst dateTo = obj => obj && (obj.endDate || obj.date || obj.to || obj.end || obj.shiftDate) || null;\nconst fmt = d => d ? new Date(d).toLocaleDateString() : \"\";\n\n/* ---------- Component ---------- */\nfunction EmployeeDashboard({\n  user\n}) {\n  _s();\n  const [myShifts, setMyShifts] = useState([]);\n  const [myLeaves, setMyLeaves] = useState([]);\n\n  // Leave form\n  const [startDate, setStartDate] = useState(\"\");\n  const [endDate, setEndDate] = useState(\"\");\n  const [reason, setReason] = useState(\"\");\n\n  // Swap form\n  const [swapForm, setSwapForm] = useState({\n    myShiftId: \"\",\n    targetShiftId: \"\",\n    // Option A: paste a shift id to swap with\n    targetUserId: \"\",\n    // Option B: enter a target user id\n    targetDate: \"\" // Option B: and a date of their shift\n  });\n\n  // API base (use .env.local -> REACT_APP_API_BASE_URL=http://localhost:5000, or CRA proxy)\n  const BASE = process.env.REACT_APP_API_BASE_URL || \"\";\n\n  // My id (from prop or localStorage)\n  const meId = useMemo(() => {\n    if (user && user._id) return user._id;\n    try {\n      const stored = JSON.parse(localStorage.getItem(\"user\") || \"{}\");\n      return stored && stored._id ? stored._id : null;\n    } catch {\n      return null;\n    }\n  }, [user]);\n\n  /* Load shifts + leaves (robust to response shapes) */\n  const loadEmployeeData = async () => {\n    try {\n      const t = localStorage.getItem(\"token\");\n      const headers = {\n        Authorization: `Bearer ${t}`\n      };\n      const [shiftsRes, leavesRes] = await Promise.all([fetch(`${BASE}${API.shifts.list}`, {\n        headers\n      }), fetch(`${BASE}${API.leaves.list}`, {\n        headers\n      })]);\n      const [shiftsRaw, leavesRaw] = await Promise.all([readBody(shiftsRes), readBody(leavesRes)]);\n\n      // Shifts: employees get only their own\n      setMyShifts(Array.isArray(shiftsRaw) ? shiftsRaw : []);\n\n      // Leaves: accept [] or {leaves:[...]} or {data:[...]}\n      const leavesArr = Array.isArray(leavesRaw) ? leavesRaw : Array.isArray(leavesRaw === null || leavesRaw === void 0 ? void 0 : leavesRaw.leaves) ? leavesRaw.leaves : Array.isArray(leavesRaw === null || leavesRaw === void 0 ? void 0 : leavesRaw.data) ? leavesRaw.data : [];\n      const mine = meId ? leavesArr.filter(l => {\n        var _l$user;\n        return (l === null || l === void 0 ? void 0 : (_l$user = l.user) === null || _l$user === void 0 ? void 0 : _l$user._id) === meId || (l === null || l === void 0 ? void 0 : l.userId) === meId || typeof (l === null || l === void 0 ? void 0 : l.user) === \"string\" && l.user === meId;\n      }) : leavesArr;\n      setMyLeaves(mine);\n    } catch (e) {\n      console.error(e);\n      setMyShifts([]);\n      setMyLeaves([]);\n    }\n  };\n  useEffect(() => {\n    loadEmployeeData();\n  }, [BASE]);\n\n  /* Submit leave -> re-fetch so it shows immediately */\n  const submitLeave = async e => {\n    e.preventDefault();\n    try {\n      const t = localStorage.getItem(\"token\");\n      const res = await fetch(`${BASE}${API.leaves.create}`, {\n        method: \"POST\",\n        headers: {\n          Authorization: `Bearer ${t}`,\n          \"Content-Type\": \"application/json\",\n          Accept: \"application/json\"\n        },\n        body: JSON.stringify({\n          startDate,\n          endDate,\n          reason\n        })\n      });\n      const body = await readBody(res);\n      if (!res.ok) {\n        console.error(\"Leave submit failed:\", res.status, body);\n        alert(body && body.message || (typeof body === \"string\" ? body : `Failed to submit leave (HTTP ${res.status})`));\n        return;\n      }\n      setStartDate(\"\");\n      setEndDate(\"\");\n      setReason(\"\");\n      await loadEmployeeData();\n    } catch (err) {\n      console.error(err);\n      alert(\"Failed to submit leave\");\n    }\n  };\n\n  /* Submit swap request */\n  const submitSwap = async e => {\n    e.preventDefault();\n    if (!swapForm.myShiftId) {\n      alert(\"Please select your shift to swap.\");\n      return;\n    }\n    if (!swapForm.targetShiftId && !(swapForm.targetUserId && swapForm.targetDate)) {\n      alert(\"Provide either a Target Shift ID, or a Target User ID + Target Date.\");\n      return;\n    }\n\n    // Build payload for your backend's /api/shifts/swap\n    // Most backends expect: { initiatorShiftId, targetShiftId }\n    // If yours expects different keys (e.g., fromShiftId/toShiftId or targetUserId/date),\n    // change ONLY this object accordingly.\n    const payload = swapForm.targetShiftId ? {\n      initiatorShiftId: swapForm.myShiftId,\n      targetShiftId: swapForm.targetShiftId\n    } : {\n      initiatorShiftId: swapForm.myShiftId,\n      targetUserId: swapForm.targetUserId,\n      date: swapForm.targetDate // if your API uses 'targetDate' or 'shiftDate', rename here\n    };\n    try {\n      const t = localStorage.getItem(\"token\");\n      const res = await fetch(`${BASE}${API.shifts.swap}`, {\n        method: \"POST\",\n        headers: {\n          Authorization: `Bearer ${t}`,\n          \"Content-Type\": \"application/json\",\n          Accept: \"application/json\"\n        },\n        body: JSON.stringify(payload)\n      });\n      const body = await readBody(res);\n      if (!res.ok) {\n        console.error(\"Swap request failed:\", res.status, body);\n        alert(body && body.message || (typeof body === \"string\" ? body : `Failed to request swap (HTTP ${res.status})`));\n        return;\n      }\n\n      // Success\n      setSwapForm({\n        myShiftId: \"\",\n        targetShiftId: \"\",\n        targetUserId: \"\",\n        targetDate: \"\"\n      });\n      alert(\"Swap request sent!\");\n    } catch (err) {\n      console.error(err);\n      alert(\"Failed to request swap\");\n    }\n  };\n\n  // Helpful label for shift options\n  const shiftLabel = s => {\n    const d = s.date || s.shiftDate || s.startDate || s.assignedDate || s.scheduledFor || s.day || s.dayDate;\n    const ds = d ? new Date(d).toLocaleDateString() : \"(no date)\";\n    const id = s._id ? ` â€“ ${s._id.slice(-6)}` : \"\";\n    return `${ds}${id}`;\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"container py-3\",\n    children: [/*#__PURE__*/_jsxDEV(\"section\", {\n      className: \"card shadow-sm p-3 mb-3\",\n      children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n        className: \"mb-3 text-primary fw-bold\",\n        children: \"My Shifts\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 220,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"ul\", {\n        className: \"list-unstyled d-grid gap-2\",\n        children: [myShifts.map((s, i) => /*#__PURE__*/_jsxDEV(\"li\", {\n          className: \"d-flex flex-wrap align-items-center justify-content-between gap-2 border rounded-3 p-2\",\n          children: /*#__PURE__*/_jsxDEV(\"span\", {\n            children: shiftLabel(s)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 227,\n            columnNumber: 15\n          }, this)\n        }, s._id || `shift-${i}`, false, {\n          fileName: _jsxFileName,\n          lineNumber: 223,\n          columnNumber: 13\n        }, this)), myShifts.length === 0 && /*#__PURE__*/_jsxDEV(\"li\", {\n          className: \"text-muted\",\n          children: \"No shifts found.\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 230,\n          columnNumber: 37\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 221,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 219,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"section\", {\n      className: \"card shadow-sm p-3 mb-3\",\n      children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n        className: \"mb-3 text-primary fw-bold\",\n        children: \"Request Swap\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 236,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"form\", {\n        className: \"row g-3\",\n        onSubmit: submitSwap,\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"col-12 col-md-6\",\n          children: [/*#__PURE__*/_jsxDEV(\"label\", {\n            className: \"form-label\",\n            children: \"My shift\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 239,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"select\", {\n            className: \"form-select\",\n            value: swapForm.myShiftId,\n            onChange: e => setSwapForm({\n              ...swapForm,\n              myShiftId: e.target.value\n            }),\n            required: true,\n            children: [/*#__PURE__*/_jsxDEV(\"option\", {\n              value: \"\",\n              children: \"Select your shift\\u2026\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 246,\n              columnNumber: 15\n            }, this), myShifts.map(s => /*#__PURE__*/_jsxDEV(\"option\", {\n              value: s._id,\n              children: shiftLabel(s)\n            }, s._id, false, {\n              fileName: _jsxFileName,\n              lineNumber: 248,\n              columnNumber: 17\n            }, this))]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 240,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"form-text\",\n            children: \"Choose the shift you want to swap away.\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 253,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 238,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"col-12\",\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"small text-secondary\",\n            children: [\"Provide \", /*#__PURE__*/_jsxDEV(\"b\", {\n              children: \"either\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 257,\n              columnNumber: 59\n            }, this), \" a Target Shift ID, \", /*#__PURE__*/_jsxDEV(\"b\", {\n              children: \"or\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 257,\n              columnNumber: 92\n            }, this), \" a Target User ID + Date.\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 257,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 256,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"col-12 col-md-6\",\n          children: [/*#__PURE__*/_jsxDEV(\"label\", {\n            className: \"form-label\",\n            children: \"Target shift ID (optional)\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 262,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n            type: \"text\",\n            className: \"form-control\",\n            placeholder: \"e.g. 652adf\\u2026\",\n            value: swapForm.targetShiftId,\n            onChange: e => setSwapForm({\n              ...swapForm,\n              targetShiftId: e.target.value\n            })\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 263,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"form-text\",\n            children: \"Paste the other person\\u2019s shift ID if you know it.\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 270,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 261,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"col-12 col-md-4\",\n          children: [/*#__PURE__*/_jsxDEV(\"label\", {\n            className: \"form-label\",\n            children: \"Target user ID (optional)\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 275,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n            type: \"text\",\n            className: \"form-control\",\n            placeholder: \"user id\",\n            value: swapForm.targetUserId,\n            onChange: e => setSwapForm({\n              ...swapForm,\n              targetUserId: e.target.value\n            })\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 276,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 274,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"col-12 col-md-2\",\n          children: [/*#__PURE__*/_jsxDEV(\"label\", {\n            className: \"form-label\",\n            children: \"Target date\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 285,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n            type: \"date\",\n            className: \"form-control\",\n            value: swapForm.targetDate,\n            onChange: e => setSwapForm({\n              ...swapForm,\n              targetDate: e.target.value\n            })\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 286,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 284,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"col-12 d-flex justify-content-end\",\n          children: /*#__PURE__*/_jsxDEV(\"button\", {\n            type: \"submit\",\n            className: \"btn btn-primary\",\n            children: \"Request Swap\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 295,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 294,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 237,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 235,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"section\", {\n      className: \"card shadow-sm p-3 mb-3\",\n      children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n        className: \"mb-3 text-primary fw-bold\",\n        children: \"Request Leave\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 302,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"form\", {\n        className: \"row g-2\",\n        onSubmit: submitLeave,\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"col-12 col-sm-6\",\n          children: [/*#__PURE__*/_jsxDEV(\"label\", {\n            htmlFor: \"start\",\n            className: \"form-label\",\n            children: \"Start date\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 305,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n            id: \"start\",\n            type: \"date\",\n            className: \"form-control\",\n            value: startDate,\n            onChange: e => setStartDate(e.target.value),\n            required: true\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 306,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 304,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"col-12 col-sm-6\",\n          children: [/*#__PURE__*/_jsxDEV(\"label\", {\n            htmlFor: \"end\",\n            className: \"form-label\",\n            children: \"End date\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 316,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n            id: \"end\",\n            type: \"date\",\n            className: \"form-control\",\n            value: endDate,\n            onChange: e => setEndDate(e.target.value),\n            required: true\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 317,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 315,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"col-12\",\n          children: [/*#__PURE__*/_jsxDEV(\"label\", {\n            htmlFor: \"reason\",\n            className: \"form-label\",\n            children: \"Reason (optional)\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 327,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"textarea\", {\n            id: \"reason\",\n            rows: 3,\n            className: \"form-control\",\n            placeholder: \"e.g., personal leave\",\n            value: reason,\n            onChange: e => setReason(e.target.value)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 328,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 326,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"col-12 d-flex justify-content-end\",\n          children: /*#__PURE__*/_jsxDEV(\"button\", {\n            type: \"submit\",\n            className: \"btn btn-primary\",\n            children: \"Submit Request\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 338,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 337,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 303,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 301,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"section\", {\n      className: \"card shadow-sm p-3\",\n      children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n        className: \"mb-3 text-primary fw-bold\",\n        children: \"My Leave Requests\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 345,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"ul\", {\n        className: \"list-unstyled d-grid gap-2\",\n        children: [myLeaves.map(l => /*#__PURE__*/_jsxDEV(\"li\", {\n          className: \"d-flex flex-wrap align-items-center justify-content-between gap-2 border rounded-3 p-2\",\n          children: /*#__PURE__*/_jsxDEV(\"span\", {\n            children: [fmt(dateFrom(l)), \" \\u2192 \", fmt(dateTo(l)), \" \\u2014 \", l.status || \"pending\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 352,\n            columnNumber: 15\n          }, this)\n        }, l._id, false, {\n          fileName: _jsxFileName,\n          lineNumber: 348,\n          columnNumber: 13\n        }, this)), myLeaves.length === 0 && /*#__PURE__*/_jsxDEV(\"li\", {\n          className: \"text-muted\",\n          children: \"No leave requests yet.\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 358,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 346,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 344,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 217,\n    columnNumber: 5\n  }, this);\n}\n_s(EmployeeDashboard, \"oLlhTn/HgDMsHRhYu2ZNge0ZOtE=\");\n_c = EmployeeDashboard;\nexport default EmployeeDashboard;\nvar _c;\n$RefreshReg$(_c, \"EmployeeDashboard\");","map":{"version":3,"names":["React","useEffect","useMemo","useState","jsxDEV","_jsxDEV","API","shifts","list","swap","leaves","create","readBody","res","ct","headers","get","includes","json","text","dateFrom","obj","startDate","date","from","start","shiftDate","dateTo","endDate","to","end","fmt","d","Date","toLocaleDateString","EmployeeDashboard","user","_s","myShifts","setMyShifts","myLeaves","setMyLeaves","setStartDate","setEndDate","reason","setReason","swapForm","setSwapForm","myShiftId","targetShiftId","targetUserId","targetDate","BASE","process","env","REACT_APP_API_BASE_URL","meId","_id","stored","JSON","parse","localStorage","getItem","loadEmployeeData","t","Authorization","shiftsRes","leavesRes","Promise","all","fetch","shiftsRaw","leavesRaw","Array","isArray","leavesArr","data","mine","filter","l","_l$user","userId","e","console","error","submitLeave","preventDefault","method","Accept","body","stringify","ok","status","alert","message","err","submitSwap","payload","initiatorShiftId","shiftLabel","s","assignedDate","scheduledFor","day","dayDate","ds","id","slice","className","children","fileName","_jsxFileName","lineNumber","columnNumber","map","i","length","onSubmit","value","onChange","target","required","type","placeholder","htmlFor","rows","_c","$RefreshReg$"],"sources":["C:/Users/adith/OneDrive/Desktop/IFN636_Assignment2/Frontend/src/components/EmployeeDashboard.jsx"],"sourcesContent":["import React, { useEffect, useMemo, useState } from \"react\";\r\n\r\n/* ===== API paths (match your backend) ===== */\r\nconst API = {\r\n  shifts: {\r\n    list: \"/api/shifts\",      // GET (employees get own shifts)\r\n    swap: \"/api/shifts/swap\", // POST (employee proposes swap)\r\n  },\r\n  leaves: {\r\n    list: \"/api/leaves\",      // GET\r\n    create: \"/api/leaves\",    // POST\r\n  },\r\n};\r\n\r\n/* Safe body reader (JSON or text) */\r\nconst readBody = async (res) => {\r\n  const ct = res.headers.get(\"content-type\") || \"\";\r\n  if (ct.includes(\"application/json\")) {\r\n    try { return await res.json(); } catch { return null; }\r\n  }\r\n  try { return await res.text(); } catch { return null; }\r\n};\r\n\r\n/* Flexible date helpers (handles various field names) */\r\nconst dateFrom = (obj) =>\r\n  (obj && (obj.startDate || obj.date || obj.from || obj.start || obj.shiftDate)) || null;\r\nconst dateTo = (obj) =>\r\n  (obj && (obj.endDate || obj.date || obj.to || obj.end || obj.shiftDate)) || null;\r\n\r\nconst fmt = (d) => (d ? new Date(d).toLocaleDateString() : \"\");\r\n\r\n/* ---------- Component ---------- */\r\nfunction EmployeeDashboard({ user }) {\r\n  const [myShifts, setMyShifts] = useState([]);\r\n  const [myLeaves, setMyLeaves] = useState([]);\r\n\r\n  // Leave form\r\n  const [startDate, setStartDate] = useState(\"\");\r\n  const [endDate, setEndDate] = useState(\"\");\r\n  const [reason, setReason] = useState(\"\");\r\n\r\n  // Swap form\r\n  const [swapForm, setSwapForm] = useState({\r\n    myShiftId: \"\",\r\n    targetShiftId: \"\",  // Option A: paste a shift id to swap with\r\n    targetUserId: \"\",   // Option B: enter a target user id\r\n    targetDate: \"\",     // Option B: and a date of their shift\r\n  });\r\n\r\n  // API base (use .env.local -> REACT_APP_API_BASE_URL=http://localhost:5000, or CRA proxy)\r\n  const BASE = process.env.REACT_APP_API_BASE_URL || \"\";\r\n\r\n  // My id (from prop or localStorage)\r\n  const meId = useMemo(() => {\r\n    if (user && user._id) return user._id;\r\n    try {\r\n      const stored = JSON.parse(localStorage.getItem(\"user\") || \"{}\");\r\n      return stored && stored._id ? stored._id : null;\r\n    } catch {\r\n      return null;\r\n    }\r\n  }, [user]);\r\n\r\n  /* Load shifts + leaves (robust to response shapes) */\r\n  const loadEmployeeData = async () => {\r\n    try {\r\n      const t = localStorage.getItem(\"token\");\r\n      const headers = { Authorization: `Bearer ${t}` };\r\n\r\n      const [shiftsRes, leavesRes] = await Promise.all([\r\n        fetch(`${BASE}${API.shifts.list}`, { headers }),\r\n        fetch(`${BASE}${API.leaves.list}`, { headers }),\r\n      ]);\r\n\r\n      const [shiftsRaw, leavesRaw] = await Promise.all([\r\n        readBody(shiftsRes),\r\n        readBody(leavesRes),\r\n      ]);\r\n\r\n      // Shifts: employees get only their own\r\n      setMyShifts(Array.isArray(shiftsRaw) ? shiftsRaw : []);\r\n\r\n      // Leaves: accept [] or {leaves:[...]} or {data:[...]}\r\n      const leavesArr = Array.isArray(leavesRaw)\r\n        ? leavesRaw\r\n        : Array.isArray(leavesRaw?.leaves)\r\n        ? leavesRaw.leaves\r\n        : Array.isArray(leavesRaw?.data)\r\n        ? leavesRaw.data\r\n        : [];\r\n\r\n      const mine = meId\r\n        ? leavesArr.filter(\r\n            (l) =>\r\n              l?.user?._id === meId ||\r\n              l?.userId === meId ||\r\n              (typeof l?.user === \"string\" && l.user === meId)\r\n          )\r\n        : leavesArr;\r\n\r\n      setMyLeaves(mine);\r\n    } catch (e) {\r\n      console.error(e);\r\n      setMyShifts([]);\r\n      setMyLeaves([]);\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    loadEmployeeData();\r\n  }, [BASE]);\r\n\r\n  /* Submit leave -> re-fetch so it shows immediately */\r\n  const submitLeave = async (e) => {\r\n    e.preventDefault();\r\n    try {\r\n      const t = localStorage.getItem(\"token\");\r\n      const res = await fetch(`${BASE}${API.leaves.create}`, {\r\n        method: \"POST\",\r\n        headers: {\r\n          Authorization: `Bearer ${t}`,\r\n          \"Content-Type\": \"application/json\",\r\n          Accept: \"application/json\",\r\n        },\r\n        body: JSON.stringify({ startDate, endDate, reason }),\r\n      });\r\n\r\n      const body = await readBody(res);\r\n      if (!res.ok) {\r\n        console.error(\"Leave submit failed:\", res.status, body);\r\n        alert(\r\n          (body && body.message) ||\r\n            (typeof body === \"string\" ? body : `Failed to submit leave (HTTP ${res.status})`)\r\n        );\r\n        return;\r\n      }\r\n\r\n      setStartDate(\"\");\r\n      setEndDate(\"\");\r\n      setReason(\"\");\r\n      await loadEmployeeData();\r\n    } catch (err) {\r\n      console.error(err);\r\n      alert(\"Failed to submit leave\");\r\n    }\r\n  };\r\n\r\n  /* Submit swap request */\r\n  const submitSwap = async (e) => {\r\n    e.preventDefault();\r\n\r\n    if (!swapForm.myShiftId) {\r\n      alert(\"Please select your shift to swap.\");\r\n      return;\r\n    }\r\n    if (!swapForm.targetShiftId && !(swapForm.targetUserId && swapForm.targetDate)) {\r\n      alert(\"Provide either a Target Shift ID, or a Target User ID + Target Date.\");\r\n      return;\r\n    }\r\n\r\n    // Build payload for your backend's /api/shifts/swap\r\n    // Most backends expect: { initiatorShiftId, targetShiftId }\r\n    // If yours expects different keys (e.g., fromShiftId/toShiftId or targetUserId/date),\r\n    // change ONLY this object accordingly.\r\n    const payload = swapForm.targetShiftId\r\n      ? {\r\n          initiatorShiftId: swapForm.myShiftId,\r\n          targetShiftId: swapForm.targetShiftId,\r\n        }\r\n      : {\r\n          initiatorShiftId: swapForm.myShiftId,\r\n          targetUserId: swapForm.targetUserId,\r\n          date: swapForm.targetDate, // if your API uses 'targetDate' or 'shiftDate', rename here\r\n        };\r\n\r\n    try {\r\n      const t = localStorage.getItem(\"token\");\r\n      const res = await fetch(`${BASE}${API.shifts.swap}`, {\r\n        method: \"POST\",\r\n        headers: {\r\n          Authorization: `Bearer ${t}`,\r\n          \"Content-Type\": \"application/json\",\r\n          Accept: \"application/json\",\r\n        },\r\n        body: JSON.stringify(payload),\r\n      });\r\n\r\n      const body = await readBody(res);\r\n      if (!res.ok) {\r\n        console.error(\"Swap request failed:\", res.status, body);\r\n        alert(\r\n          (body && body.message) ||\r\n            (typeof body === \"string\" ? body : `Failed to request swap (HTTP ${res.status})`)\r\n        );\r\n        return;\r\n      }\r\n\r\n      // Success\r\n      setSwapForm({ myShiftId: \"\", targetShiftId: \"\", targetUserId: \"\", targetDate: \"\" });\r\n      alert(\"Swap request sent!\");\r\n    } catch (err) {\r\n      console.error(err);\r\n      alert(\"Failed to request swap\");\r\n    }\r\n  };\r\n\r\n  // Helpful label for shift options\r\n  const shiftLabel = (s) => {\r\n    const d =\r\n      s.date || s.shiftDate || s.startDate || s.assignedDate || s.scheduledFor || s.day || s.dayDate;\r\n    const ds = d ? new Date(d).toLocaleDateString() : \"(no date)\";\r\n    const id = s._id ? ` â€“ ${s._id.slice(-6)}` : \"\";\r\n    return `${ds}${id}`;\r\n  };\r\n\r\n  return (\r\n    <div className=\"container py-3\">\r\n      {/* My Shifts */}\r\n      <section className=\"card shadow-sm p-3 mb-3\">\r\n        <h3 className=\"mb-3 text-primary fw-bold\">My Shifts</h3>\r\n        <ul className=\"list-unstyled d-grid gap-2\">\r\n          {myShifts.map((s, i) => (\r\n            <li\r\n              key={s._id || `shift-${i}`}\r\n              className=\"d-flex flex-wrap align-items-center justify-content-between gap-2 border rounded-3 p-2\"\r\n            >\r\n              <span>{shiftLabel(s)}</span>\r\n            </li>\r\n          ))}\r\n          {myShifts.length === 0 && <li className=\"text-muted\">No shifts found.</li>}\r\n        </ul>\r\n      </section>\r\n\r\n      {/* Request Swap */}\r\n      <section className=\"card shadow-sm p-3 mb-3\">\r\n        <h3 className=\"mb-3 text-primary fw-bold\">Request Swap</h3>\r\n        <form className=\"row g-3\" onSubmit={submitSwap}>\r\n          <div className=\"col-12 col-md-6\">\r\n            <label className=\"form-label\">My shift</label>\r\n            <select\r\n              className=\"form-select\"\r\n              value={swapForm.myShiftId}\r\n              onChange={(e) => setSwapForm({ ...swapForm, myShiftId: e.target.value })}\r\n              required\r\n            >\r\n              <option value=\"\">Select your shiftâ€¦</option>\r\n              {myShifts.map((s) => (\r\n                <option key={s._id} value={s._id}>\r\n                  {shiftLabel(s)}\r\n                </option>\r\n              ))}\r\n            </select>\r\n            <div className=\"form-text\">Choose the shift you want to swap away.</div>\r\n          </div>\r\n\r\n          <div className=\"col-12\">\r\n            <div className=\"small text-secondary\">Provide <b>either</b> a Target Shift ID, <b>or</b> a Target User ID + Date.</div>\r\n          </div>\r\n\r\n          {/* Option A â€” direct target shift id */}\r\n          <div className=\"col-12 col-md-6\">\r\n            <label className=\"form-label\">Target shift ID (optional)</label>\r\n            <input\r\n              type=\"text\"\r\n              className=\"form-control\"\r\n              placeholder=\"e.g. 652adfâ€¦\"\r\n              value={swapForm.targetShiftId}\r\n              onChange={(e) => setSwapForm({ ...swapForm, targetShiftId: e.target.value })}\r\n            />\r\n            <div className=\"form-text\">Paste the other personâ€™s shift ID if you know it.</div>\r\n          </div>\r\n\r\n          {/* Option B â€” target user and date */}\r\n          <div className=\"col-12 col-md-4\">\r\n            <label className=\"form-label\">Target user ID (optional)</label>\r\n            <input\r\n              type=\"text\"\r\n              className=\"form-control\"\r\n              placeholder=\"user id\"\r\n              value={swapForm.targetUserId}\r\n              onChange={(e) => setSwapForm({ ...swapForm, targetUserId: e.target.value })}\r\n            />\r\n          </div>\r\n          <div className=\"col-12 col-md-2\">\r\n            <label className=\"form-label\">Target date</label>\r\n            <input\r\n              type=\"date\"\r\n              className=\"form-control\"\r\n              value={swapForm.targetDate}\r\n              onChange={(e) => setSwapForm({ ...swapForm, targetDate: e.target.value })}\r\n            />\r\n          </div>\r\n\r\n          <div className=\"col-12 d-flex justify-content-end\">\r\n            <button type=\"submit\" className=\"btn btn-primary\">Request Swap</button>\r\n          </div>\r\n        </form>\r\n      </section>\r\n\r\n      {/* Request Leave */}\r\n      <section className=\"card shadow-sm p-3 mb-3\">\r\n        <h3 className=\"mb-3 text-primary fw-bold\">Request Leave</h3>\r\n        <form className=\"row g-2\" onSubmit={submitLeave}>\r\n          <div className=\"col-12 col-sm-6\">\r\n            <label htmlFor=\"start\" className=\"form-label\">Start date</label>\r\n            <input\r\n              id=\"start\"\r\n              type=\"date\"\r\n              className=\"form-control\"\r\n              value={startDate}\r\n              onChange={(e) => setStartDate(e.target.value)}\r\n              required\r\n            />\r\n          </div>\r\n          <div className=\"col-12 col-sm-6\">\r\n            <label htmlFor=\"end\" className=\"form-label\">End date</label>\r\n            <input\r\n              id=\"end\"\r\n              type=\"date\"\r\n              className=\"form-control\"\r\n              value={endDate}\r\n              onChange={(e) => setEndDate(e.target.value)}\r\n              required\r\n            />\r\n          </div>\r\n          <div className=\"col-12\">\r\n            <label htmlFor=\"reason\" className=\"form-label\">Reason (optional)</label>\r\n            <textarea\r\n              id=\"reason\"\r\n              rows={3}\r\n              className=\"form-control\"\r\n              placeholder=\"e.g., personal leave\"\r\n              value={reason}\r\n              onChange={(e) => setReason(e.target.value)}\r\n            />\r\n          </div>\r\n          <div className=\"col-12 d-flex justify-content-end\">\r\n            <button type=\"submit\" className=\"btn btn-primary\">Submit Request</button>\r\n          </div>\r\n        </form>\r\n      </section>\r\n\r\n      {/* My Leave Requests */}\r\n      <section className=\"card shadow-sm p-3\">\r\n        <h3 className=\"mb-3 text-primary fw-bold\">My Leave Requests</h3>\r\n        <ul className=\"list-unstyled d-grid gap-2\">\r\n          {myLeaves.map((l) => (\r\n            <li\r\n              key={l._id}\r\n              className=\"d-flex flex-wrap align-items-center justify-content-between gap-2 border rounded-3 p-2\"\r\n            >\r\n              <span>\r\n                {fmt(dateFrom(l))} &rarr; {fmt(dateTo(l))} â€” {l.status || \"pending\"}\r\n              </span>\r\n            </li>\r\n          ))}\r\n          {myLeaves.length === 0 && (\r\n            <li className=\"text-muted\">No leave requests yet.</li>\r\n          )}\r\n        </ul>\r\n      </section>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default EmployeeDashboard;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}